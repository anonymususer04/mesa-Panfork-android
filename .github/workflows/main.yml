name: make a mesa
on:
   workflow_dispatch:
jobs:
  job-ubuntu:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: download archives
        run: |
          sudo apt-get install git wget meson ninja* python3 *x11* *wayland*
          pip3 install mako setuptools
      - name: prepar achivers 
        run: |
          wget https://dl.google.com/android/repository/android-ndk-r27c-linux.zip
          unzip android-ndk-r27-linux.zip
          mv android-ndk-r27-linix /home/runner
          export PATH=$PATH:/home/runner/android-ndk-r27-linux/llvm/prebuilt/linux-x86_64/bin
          mkdir /home/runner/mesa
          git clone https://github.com/anonymususer04/mesa-Panfork-android.git
          cd mesa-Panfork-android
          LDFLAGS=" -L$PREFIX/bin -l:libandroid-shmem.a -llog -Wl,--undefined-version"  meson  build -Dgallium-drivers=panfrost,swrast -Dvulkan-drivers= -Dbuildtype=release -Dllvm=disabled -Dplatforms=x11,wayland  -Dprefix=/home/runner/mesa && ninja -C build install
          tar -cvf /home/runner/mesa-panfork.tar.gz /home/runner/mesa
          
